
---

### **6.1 数据链路层概述**

#### **6.1.1 数据链路层的基本概念**

**1. 核心地位**
数据链路层位于**物理层**（第1层）和**网络层**（第3层）之间。
*   **向下**：利用物理层提供的比特流传输服务。
*   **向上**：为网络层提供可靠（或尽力而为）的链路传输服务。

**2. 两个关键术语：链路 vs 数据链路**
这是本章最基础的概念区分：
*   **链路 (Link)**：一条无源的点到点的**物理线路段**，中间没有任何其他的交换结点。
    *   *比喻*：这就好比是一条单纯的**柏油马路**。
*   **数据链路 (Data Link)**：**物理线路 + 实现通信协议的硬件和软件**。
    *   通常使用**网络适配器**（网卡，NIC）来实现这些协议。
    *   *比喻*：柏油马路（链路）+ 交通规则 + 红绿灯 + 摄像头 = **数据链路**。只有有了规则，车才能在路上有序跑起来。

**3. 传输单元：帧 (Frame)**
数据链路层的协议数据单元（PDU）叫做**帧**。
*   数据链路层把网络层交下来的数据（IP数据报）封装成**帧**，发送给物理层。

**4. 三个基本问题**
无论哪种数据链路层协议（以太网、PPP等），都要解决三个基本问题：
1.  **封装成帧**（怎么打包？）
2.  **差错控制**（传错了怎么办？）
3.  **可靠传输**（丢包了怎么办？*注：现代有线网络通常不在此层做复杂的可靠传输，交由TCP负责*）

---

#### **6.1.2 封装成帧 (Framing)**

**1. 什么是封装成帧？**
就是给网络层的IP数据报（数据部分），加上一个**首部 (Header)** 和一个**尾部 (Trailer)**。
*   **作用**：
    1.  **帧定界**：首部和尾部包含了特定的**帧定界符**，告诉接收端：哪里是帧的开始，哪里是帧的结束。
    2.  **承载控制信息**：如地址信息（MAC地址）、差错检测码（FCS）等。

**2. 最大传输单元 (MTU)**
*   **定义**：帧的**数据部分**（Payload，即IP数据报）的长度上限。
*   **限制**：这就像高速公路的限高杆。例如，以太网的MTU通常是 **1500字节**。如果IP数据报超过1500字节，网络层就必须进行**分片**（我们在上一章IP分片学过的内容）。

**3. 透明传输 (Transparency)**
这是一个非常有趣且重要的技术难点。
*   **问题**：假设帧的“结束标记”是特定的二进制序列（比如 `01111110`）。如果数据部分（Payload）里**恰好**也包含了这个序列，接收端会不会误以为帧提前结束了？
*   **目标**：**透明传输**意味着无论数据是什么样的（哪怕和控制字符长得一样），都能被正确传输，不会导致误判。
*   **解决方案**：
    *   **字节填充 (Byte Stuffing)**：
        *   用于**面向字符**的协议（如PPP）。
        *   如果在数据中出现了和“结束标记”一样的字符，发送方会在它前面插入一个**转义字符 (ESC)**。
        *   接收方读到转义字符，就知道后面那个字符是数据，不是结束标记，然后把转义字符删掉。
    *   **零比特填充 (Bit Stuffing)**：
        *   用于**面向比特**的协议（如HDLC）。
        *   **规则**：只要数据中连续出现了 **5个“1”**，发送方就立即在后面插入一个 **“0”**。
        *   **效果**：保证数据中永远不会出现连续的6个“1”（假设结束标记是 `01111110`）。接收方看到连续5个1后面有个0，直接把0删掉还原数据；如果看到连续6个1，就知道这是帧结束标记。

---
